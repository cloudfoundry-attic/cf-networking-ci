resources:
  - name: guardian-release
    type: git
    source:
      uri: git://github.com/cloudfoundry-incubator/guardian-release
      branch: master
  - name: ducati-release
    type: git
    source:
      uri: git://github.com/cloudfoundry-incubator/ducati-release
      branch: master

jobs:
  - name: guardian-tests-unit
    plan:
      - get: guardian-release
        trigger: true
      - task: guardian-tests-unit
        file: guardian-release/ci/nested-shed-tests.yml
        privileged: true

  - name: ducati-tests
    plan:
      - get: ducati-release
        trigger: true
      - task: ducati-tests
        file: ducati-release/ci/ducati-tests.yml
        privileged: true

  - name: gqt-ducati-tests
    plan:
      - aggregate:
        - get: ducati-release
          trigger: true
          passed: [ducati-tests]
        - get: guardian-release
          trigger: true
          passed: [guardian-tests-unit]
      - task: gqt-ducati-tests
        file: ducati-release/ci/gqt.yml
        privileged: true
